#include <driver/i2s.h>
#include "Arduino.h"

#define I2S_SAMPLE_RATE     100000
#define I2S_DMA_BUF_LEN     1024

#define ADC_INPUT           ADC1_CHANNEL_4 //pin 32

#define I2S_DATA_PIN        GPIO_NUM_22 // DIN
#define I2S_LRCK_PIN        GPIO_NUM_25 // LCK
#define I2S_BCLK_PIN        GPIO_NUM_26 // BCK

/////////////////////////

#include <math.h>
#include <malloc.h>

typedef struct {
    double real;
    double imag;
} complex;

complex cproduct(complex z1, complex z2) {
    complex res;
    res.real = z1.real * z2.real - z1.imag * z2.imag;
    res.imag = z1.real * z2.imag + z1.imag * z2.real;
    return res;
}

complex cdivz(complex z, int n) {
    complex res;
    res.real = z.real / n;
    res.imag = z.imag / n;
    return res;
}

complex csum(complex z1, complex z2) {
    complex res;
    res.real = z1.real + z2.real;
    res.imag = z1.imag + z2.imag;
    return res;
}

complex csub(complex z1, complex z2) {
    complex res;
    res.real = z1.real - z2.real;
    res.imag = z1.imag - z2.imag;
    return res;
}

void swap(complex *a, complex *b) {
    complex temp = *a;
    *a = *b;
    *b = temp;
}

complex w_arr[] = {{.real=1.000000, .imag=0.000000},
                   {.real=1.000000, .imag=0.000000},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.000000, .imag=1.000000},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.995185, .imag=0.098017},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.956940, .imag=0.290285},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.881921, .imag=0.471397},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.773010, .imag=0.634393},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.634393, .imag=0.773010},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.471397, .imag=0.881921},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.290285, .imag=0.956940},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.098017, .imag=0.995185},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.098017, .imag=0.995185},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.290285, .imag=0.956940},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.471397, .imag=0.881921},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.634393, .imag=0.773010},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.773010, .imag=0.634393},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.881921, .imag=0.471397},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.956940, .imag=0.290285},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=-0.995185, .imag=0.098017},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.998795, .imag=0.049068},
                   {.real=0.995185, .imag=0.098017},
                   {.real=0.989177, .imag=0.146730},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.970031, .imag=0.242980},
                   {.real=0.956940, .imag=0.290285},
                   {.real=0.941544, .imag=0.336890},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.903989, .imag=0.427555},
                   {.real=0.881921, .imag=0.471397},
                   {.real=0.857729, .imag=0.514103},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.803208, .imag=0.595699},
                   {.real=0.773010, .imag=0.634393},
                   {.real=0.740951, .imag=0.671559},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.671559, .imag=0.740951},
                   {.real=0.634393, .imag=0.773010},
                   {.real=0.595699, .imag=0.803208},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.514103, .imag=0.857729},
                   {.real=0.471397, .imag=0.881921},
                   {.real=0.427555, .imag=0.903989},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.336890, .imag=0.941544},
                   {.real=0.290285, .imag=0.956940},
                   {.real=0.242980, .imag=0.970031},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.146730, .imag=0.989177},
                   {.real=0.098017, .imag=0.995185},
                   {.real=0.049068, .imag=0.998795},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.049068, .imag=0.998795},
                   {.real=-0.098017, .imag=0.995185},
                   {.real=-0.146730, .imag=0.989177},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.242980, .imag=0.970031},
                   {.real=-0.290285, .imag=0.956940},
                   {.real=-0.336890, .imag=0.941544},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.427555, .imag=0.903989},
                   {.real=-0.471397, .imag=0.881921},
                   {.real=-0.514103, .imag=0.857729},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.595699, .imag=0.803208},
                   {.real=-0.634393, .imag=0.773010},
                   {.real=-0.671559, .imag=0.740951},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.740951, .imag=0.671559},
                   {.real=-0.773010, .imag=0.634393},
                   {.real=-0.803208, .imag=0.595699},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.857729, .imag=0.514103},
                   {.real=-0.881921, .imag=0.471397},
                   {.real=-0.903989, .imag=0.427555},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.941544, .imag=0.336890},
                   {.real=-0.956940, .imag=0.290285},
                   {.real=-0.970031, .imag=0.242980},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=-0.989177, .imag=0.146730},
                   {.real=-0.995185, .imag=0.098017},
                   {.real=-0.998795, .imag=0.049068},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.999699, .imag=0.024541},
                   {.real=0.998795, .imag=0.049068},
                   {.real=0.997290, .imag=0.073565},
                   {.real=0.995185, .imag=0.098017},
                   {.real=0.992480, .imag=0.122411},
                   {.real=0.989177, .imag=0.146730},
                   {.real=0.985278, .imag=0.170962},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.975702, .imag=0.219101},
                   {.real=0.970031, .imag=0.242980},
                   {.real=0.963776, .imag=0.266713},
                   {.real=0.956940, .imag=0.290285},
                   {.real=0.949528, .imag=0.313682},
                   {.real=0.941544, .imag=0.336890},
                   {.real=0.932993, .imag=0.359895},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.914210, .imag=0.405241},
                   {.real=0.903989, .imag=0.427555},
                   {.real=0.893224, .imag=0.449611},
                   {.real=0.881921, .imag=0.471397},
                   {.real=0.870087, .imag=0.492898},
                   {.real=0.857729, .imag=0.514103},
                   {.real=0.844854, .imag=0.534998},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.817585, .imag=0.575808},
                   {.real=0.803208, .imag=0.595699},
                   {.real=0.788346, .imag=0.615232},
                   {.real=0.773010, .imag=0.634393},
                   {.real=0.757209, .imag=0.653173},
                   {.real=0.740951, .imag=0.671559},
                   {.real=0.724247, .imag=0.689541},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.689541, .imag=0.724247},
                   {.real=0.671559, .imag=0.740951},
                   {.real=0.653173, .imag=0.757209},
                   {.real=0.634393, .imag=0.773010},
                   {.real=0.615232, .imag=0.788346},
                   {.real=0.595699, .imag=0.803208},
                   {.real=0.575808, .imag=0.817585},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.534998, .imag=0.844854},
                   {.real=0.514103, .imag=0.857729},
                   {.real=0.492898, .imag=0.870087},
                   {.real=0.471397, .imag=0.881921},
                   {.real=0.449611, .imag=0.893224},
                   {.real=0.427555, .imag=0.903989},
                   {.real=0.405241, .imag=0.914210},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.359895, .imag=0.932993},
                   {.real=0.336890, .imag=0.941544},
                   {.real=0.313682, .imag=0.949528},
                   {.real=0.290285, .imag=0.956940},
                   {.real=0.266713, .imag=0.963776},
                   {.real=0.242980, .imag=0.970031},
                   {.real=0.219101, .imag=0.975702},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.170962, .imag=0.985278},
                   {.real=0.146730, .imag=0.989177},
                   {.real=0.122411, .imag=0.992480},
                   {.real=0.098017, .imag=0.995185},
                   {.real=0.073565, .imag=0.997290},
                   {.real=0.049068, .imag=0.998795},
                   {.real=0.024541, .imag=0.999699},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.024541, .imag=0.999699},
                   {.real=-0.049068, .imag=0.998795},
                   {.real=-0.073565, .imag=0.997290},
                   {.real=-0.098017, .imag=0.995185},
                   {.real=-0.122411, .imag=0.992480},
                   {.real=-0.146730, .imag=0.989177},
                   {.real=-0.170962, .imag=0.985278},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.219101, .imag=0.975702},
                   {.real=-0.242980, .imag=0.970031},
                   {.real=-0.266713, .imag=0.963776},
                   {.real=-0.290285, .imag=0.956940},
                   {.real=-0.313682, .imag=0.949528},
                   {.real=-0.336890, .imag=0.941544},
                   {.real=-0.359895, .imag=0.932993},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.405241, .imag=0.914210},
                   {.real=-0.427555, .imag=0.903989},
                   {.real=-0.449611, .imag=0.893224},
                   {.real=-0.471397, .imag=0.881921},
                   {.real=-0.492898, .imag=0.870087},
                   {.real=-0.514103, .imag=0.857729},
                   {.real=-0.534998, .imag=0.844854},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.575808, .imag=0.817585},
                   {.real=-0.595699, .imag=0.803208},
                   {.real=-0.615232, .imag=0.788346},
                   {.real=-0.634393, .imag=0.773010},
                   {.real=-0.653173, .imag=0.757209},
                   {.real=-0.671559, .imag=0.740951},
                   {.real=-0.689541, .imag=0.724247},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.724247, .imag=0.689541},
                   {.real=-0.740951, .imag=0.671559},
                   {.real=-0.757209, .imag=0.653173},
                   {.real=-0.773010, .imag=0.634393},
                   {.real=-0.788346, .imag=0.615232},
                   {.real=-0.803208, .imag=0.595699},
                   {.real=-0.817585, .imag=0.575808},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.844854, .imag=0.534998},
                   {.real=-0.857729, .imag=0.514103},
                   {.real=-0.870087, .imag=0.492898},
                   {.real=-0.881921, .imag=0.471397},
                   {.real=-0.893224, .imag=0.449611},
                   {.real=-0.903989, .imag=0.427555},
                   {.real=-0.914210, .imag=0.405241},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.932993, .imag=0.359895},
                   {.real=-0.941544, .imag=0.336890},
                   {.real=-0.949528, .imag=0.313682},
                   {.real=-0.956940, .imag=0.290285},
                   {.real=-0.963776, .imag=0.266713},
                   {.real=-0.970031, .imag=0.242980},
                   {.real=-0.975702, .imag=0.219101},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=-0.985278, .imag=0.170962},
                   {.real=-0.989177, .imag=0.146730},
                   {.real=-0.992480, .imag=0.122411},
                   {.real=-0.995185, .imag=0.098017},
                   {.real=-0.997290, .imag=0.073565},
                   {.real=-0.998795, .imag=0.049068},
                   {.real=-0.999699, .imag=0.024541},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.999925, .imag=0.012272},
                   {.real=0.999699, .imag=0.024541},
                   {.real=0.999322, .imag=0.036807},
                   {.real=0.998795, .imag=0.049068},
                   {.real=0.998118, .imag=0.061321},
                   {.real=0.997290, .imag=0.073565},
                   {.real=0.996313, .imag=0.085797},
                   {.real=0.995185, .imag=0.098017},
                   {.real=0.993907, .imag=0.110222},
                   {.real=0.992480, .imag=0.122411},
                   {.real=0.990903, .imag=0.134581},
                   {.real=0.989177, .imag=0.146730},
                   {.real=0.987301, .imag=0.158858},
                   {.real=0.985278, .imag=0.170962},
                   {.real=0.983105, .imag=0.183040},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.978317, .imag=0.207111},
                   {.real=0.975702, .imag=0.219101},
                   {.real=0.972940, .imag=0.231058},
                   {.real=0.970031, .imag=0.242980},
                   {.real=0.966976, .imag=0.254866},
                   {.real=0.963776, .imag=0.266713},
                   {.real=0.960431, .imag=0.278520},
                   {.real=0.956940, .imag=0.290285},
                   {.real=0.953306, .imag=0.302006},
                   {.real=0.949528, .imag=0.313682},
                   {.real=0.945607, .imag=0.325310},
                   {.real=0.941544, .imag=0.336890},
                   {.real=0.937339, .imag=0.348419},
                   {.real=0.932993, .imag=0.359895},
                   {.real=0.928506, .imag=0.371317},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.919114, .imag=0.393992},
                   {.real=0.914210, .imag=0.405241},
                   {.real=0.909168, .imag=0.416430},
                   {.real=0.903989, .imag=0.427555},
                   {.real=0.898674, .imag=0.438616},
                   {.real=0.893224, .imag=0.449611},
                   {.real=0.887640, .imag=0.460539},
                   {.real=0.881921, .imag=0.471397},
                   {.real=0.876070, .imag=0.482184},
                   {.real=0.870087, .imag=0.492898},
                   {.real=0.863973, .imag=0.503538},
                   {.real=0.857729, .imag=0.514103},
                   {.real=0.851355, .imag=0.524590},
                   {.real=0.844854, .imag=0.534998},
                   {.real=0.838225, .imag=0.545325},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.824589, .imag=0.565732},
                   {.real=0.817585, .imag=0.575808},
                   {.real=0.810457, .imag=0.585798},
                   {.real=0.803208, .imag=0.595699},
                   {.real=0.795837, .imag=0.605511},
                   {.real=0.788346, .imag=0.615232},
                   {.real=0.780737, .imag=0.624859},
                   {.real=0.773010, .imag=0.634393},
                   {.real=0.765167, .imag=0.643832},
                   {.real=0.757209, .imag=0.653173},
                   {.real=0.749136, .imag=0.662416},
                   {.real=0.740951, .imag=0.671559},
                   {.real=0.732654, .imag=0.680601},
                   {.real=0.724247, .imag=0.689541},
                   {.real=0.715731, .imag=0.698376},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.698376, .imag=0.715731},
                   {.real=0.689541, .imag=0.724247},
                   {.real=0.680601, .imag=0.732654},
                   {.real=0.671559, .imag=0.740951},
                   {.real=0.662416, .imag=0.749136},
                   {.real=0.653173, .imag=0.757209},
                   {.real=0.643832, .imag=0.765167},
                   {.real=0.634393, .imag=0.773010},
                   {.real=0.624859, .imag=0.780737},
                   {.real=0.615232, .imag=0.788346},
                   {.real=0.605511, .imag=0.795837},
                   {.real=0.595699, .imag=0.803208},
                   {.real=0.585798, .imag=0.810457},
                   {.real=0.575808, .imag=0.817585},
                   {.real=0.565732, .imag=0.824589},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.545325, .imag=0.838225},
                   {.real=0.534998, .imag=0.844854},
                   {.real=0.524590, .imag=0.851355},
                   {.real=0.514103, .imag=0.857729},
                   {.real=0.503538, .imag=0.863973},
                   {.real=0.492898, .imag=0.870087},
                   {.real=0.482184, .imag=0.876070},
                   {.real=0.471397, .imag=0.881921},
                   {.real=0.460539, .imag=0.887640},
                   {.real=0.449611, .imag=0.893224},
                   {.real=0.438616, .imag=0.898674},
                   {.real=0.427555, .imag=0.903989},
                   {.real=0.416430, .imag=0.909168},
                   {.real=0.405241, .imag=0.914210},
                   {.real=0.393992, .imag=0.919114},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.371317, .imag=0.928506},
                   {.real=0.359895, .imag=0.932993},
                   {.real=0.348419, .imag=0.937339},
                   {.real=0.336890, .imag=0.941544},
                   {.real=0.325310, .imag=0.945607},
                   {.real=0.313682, .imag=0.949528},
                   {.real=0.302006, .imag=0.953306},
                   {.real=0.290285, .imag=0.956940},
                   {.real=0.278520, .imag=0.960431},
                   {.real=0.266713, .imag=0.963776},
                   {.real=0.254866, .imag=0.966976},
                   {.real=0.242980, .imag=0.970031},
                   {.real=0.231058, .imag=0.972940},
                   {.real=0.219101, .imag=0.975702},
                   {.real=0.207111, .imag=0.978317},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.183040, .imag=0.983105},
                   {.real=0.170962, .imag=0.985278},
                   {.real=0.158858, .imag=0.987301},
                   {.real=0.146730, .imag=0.989177},
                   {.real=0.134581, .imag=0.990903},
                   {.real=0.122411, .imag=0.992480},
                   {.real=0.110222, .imag=0.993907},
                   {.real=0.098017, .imag=0.995185},
                   {.real=0.085797, .imag=0.996313},
                   {.real=0.073565, .imag=0.997290},
                   {.real=0.061321, .imag=0.998118},
                   {.real=0.049068, .imag=0.998795},
                   {.real=0.036807, .imag=0.999322},
                   {.real=0.024541, .imag=0.999699},
                   {.real=0.012272, .imag=0.999925},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.012272, .imag=0.999925},
                   {.real=-0.024541, .imag=0.999699},
                   {.real=-0.036807, .imag=0.999322},
                   {.real=-0.049068, .imag=0.998795},
                   {.real=-0.061321, .imag=0.998118},
                   {.real=-0.073565, .imag=0.997290},
                   {.real=-0.085797, .imag=0.996313},
                   {.real=-0.098017, .imag=0.995185},
                   {.real=-0.110222, .imag=0.993907},
                   {.real=-0.122411, .imag=0.992480},
                   {.real=-0.134581, .imag=0.990903},
                   {.real=-0.146730, .imag=0.989177},
                   {.real=-0.158858, .imag=0.987301},
                   {.real=-0.170962, .imag=0.985278},
                   {.real=-0.183040, .imag=0.983105},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.207111, .imag=0.978317},
                   {.real=-0.219101, .imag=0.975702},
                   {.real=-0.231058, .imag=0.972940},
                   {.real=-0.242980, .imag=0.970031},
                   {.real=-0.254866, .imag=0.966976},
                   {.real=-0.266713, .imag=0.963776},
                   {.real=-0.278520, .imag=0.960431},
                   {.real=-0.290285, .imag=0.956940},
                   {.real=-0.302006, .imag=0.953306},
                   {.real=-0.313682, .imag=0.949528},
                   {.real=-0.325310, .imag=0.945607},
                   {.real=-0.336890, .imag=0.941544},
                   {.real=-0.348419, .imag=0.937339},
                   {.real=-0.359895, .imag=0.932993},
                   {.real=-0.371317, .imag=0.928506},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.393992, .imag=0.919114},
                   {.real=-0.405241, .imag=0.914210},
                   {.real=-0.416430, .imag=0.909168},
                   {.real=-0.427555, .imag=0.903989},
                   {.real=-0.438616, .imag=0.898674},
                   {.real=-0.449611, .imag=0.893224},
                   {.real=-0.460539, .imag=0.887640},
                   {.real=-0.471397, .imag=0.881921},
                   {.real=-0.482184, .imag=0.876070},
                   {.real=-0.492898, .imag=0.870087},
                   {.real=-0.503538, .imag=0.863973},
                   {.real=-0.514103, .imag=0.857729},
                   {.real=-0.524590, .imag=0.851355},
                   {.real=-0.534998, .imag=0.844854},
                   {.real=-0.545325, .imag=0.838225},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.565732, .imag=0.824589},
                   {.real=-0.575808, .imag=0.817585},
                   {.real=-0.585798, .imag=0.810457},
                   {.real=-0.595699, .imag=0.803208},
                   {.real=-0.605511, .imag=0.795837},
                   {.real=-0.615232, .imag=0.788346},
                   {.real=-0.624859, .imag=0.780737},
                   {.real=-0.634393, .imag=0.773010},
                   {.real=-0.643832, .imag=0.765167},
                   {.real=-0.653173, .imag=0.757209},
                   {.real=-0.662416, .imag=0.749136},
                   {.real=-0.671559, .imag=0.740951},
                   {.real=-0.680601, .imag=0.732654},
                   {.real=-0.689541, .imag=0.724247},
                   {.real=-0.698376, .imag=0.715731},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.715731, .imag=0.698376},
                   {.real=-0.724247, .imag=0.689541},
                   {.real=-0.732654, .imag=0.680601},
                   {.real=-0.740951, .imag=0.671559},
                   {.real=-0.749136, .imag=0.662416},
                   {.real=-0.757209, .imag=0.653173},
                   {.real=-0.765167, .imag=0.643832},
                   {.real=-0.773010, .imag=0.634393},
                   {.real=-0.780737, .imag=0.624859},
                   {.real=-0.788346, .imag=0.615232},
                   {.real=-0.795837, .imag=0.605511},
                   {.real=-0.803208, .imag=0.595699},
                   {.real=-0.810457, .imag=0.585798},
                   {.real=-0.817585, .imag=0.575808},
                   {.real=-0.824589, .imag=0.565732},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.838225, .imag=0.545325},
                   {.real=-0.844854, .imag=0.534998},
                   {.real=-0.851355, .imag=0.524590},
                   {.real=-0.857729, .imag=0.514103},
                   {.real=-0.863973, .imag=0.503538},
                   {.real=-0.870087, .imag=0.492898},
                   {.real=-0.876070, .imag=0.482184},
                   {.real=-0.881921, .imag=0.471397},
                   {.real=-0.887640, .imag=0.460539},
                   {.real=-0.893224, .imag=0.449611},
                   {.real=-0.898674, .imag=0.438616},
                   {.real=-0.903989, .imag=0.427555},
                   {.real=-0.909168, .imag=0.416430},
                   {.real=-0.914210, .imag=0.405241},
                   {.real=-0.919114, .imag=0.393992},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.928506, .imag=0.371317},
                   {.real=-0.932993, .imag=0.359895},
                   {.real=-0.937339, .imag=0.348419},
                   {.real=-0.941544, .imag=0.336890},
                   {.real=-0.945607, .imag=0.325310},
                   {.real=-0.949528, .imag=0.313682},
                   {.real=-0.953306, .imag=0.302006},
                   {.real=-0.956940, .imag=0.290285},
                   {.real=-0.960431, .imag=0.278520},
                   {.real=-0.963776, .imag=0.266713},
                   {.real=-0.966976, .imag=0.254866},
                   {.real=-0.970031, .imag=0.242980},
                   {.real=-0.972940, .imag=0.231058},
                   {.real=-0.975702, .imag=0.219101},
                   {.real=-0.978317, .imag=0.207111},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=-0.983105, .imag=0.183040},
                   {.real=-0.985278, .imag=0.170962},
                   {.real=-0.987301, .imag=0.158858},
                   {.real=-0.989177, .imag=0.146730},
                   {.real=-0.990903, .imag=0.134581},
                   {.real=-0.992480, .imag=0.122411},
                   {.real=-0.993907, .imag=0.110222},
                   {.real=-0.995185, .imag=0.098017},
                   {.real=-0.996313, .imag=0.085797},
                   {.real=-0.997290, .imag=0.073565},
                   {.real=-0.998118, .imag=0.061321},
                   {.real=-0.998795, .imag=0.049068},
                   {.real=-0.999322, .imag=0.036807},
                   {.real=-0.999699, .imag=0.024541},
                   {.real=-0.999925, .imag=0.012272},
                   {.real=1.000000, .imag=0.000000},
                   {.real=0.999981, .imag=0.006136},
                   {.real=0.999925, .imag=0.012272},
                   {.real=0.999831, .imag=0.018407},
                   {.real=0.999699, .imag=0.024541},
                   {.real=0.999529, .imag=0.030675},
                   {.real=0.999322, .imag=0.036807},
                   {.real=0.999078, .imag=0.042938},
                   {.real=0.998795, .imag=0.049068},
                   {.real=0.998476, .imag=0.055195},
                   {.real=0.998118, .imag=0.061321},
                   {.real=0.997723, .imag=0.067444},
                   {.real=0.997290, .imag=0.073565},
                   {.real=0.996820, .imag=0.079682},
                   {.real=0.996313, .imag=0.085797},
                   {.real=0.995767, .imag=0.091909},
                   {.real=0.995185, .imag=0.098017},
                   {.real=0.994565, .imag=0.104122},
                   {.real=0.993907, .imag=0.110222},
                   {.real=0.993212, .imag=0.116319},
                   {.real=0.992480, .imag=0.122411},
                   {.real=0.991710, .imag=0.128498},
                   {.real=0.990903, .imag=0.134581},
                   {.real=0.990058, .imag=0.140658},
                   {.real=0.989177, .imag=0.146730},
                   {.real=0.988258, .imag=0.152797},
                   {.real=0.987301, .imag=0.158858},
                   {.real=0.986308, .imag=0.164913},
                   {.real=0.985278, .imag=0.170962},
                   {.real=0.984210, .imag=0.177004},
                   {.real=0.983105, .imag=0.183040},
                   {.real=0.981964, .imag=0.189069},
                   {.real=0.980785, .imag=0.195090},
                   {.real=0.979570, .imag=0.201105},
                   {.real=0.978317, .imag=0.207111},
                   {.real=0.977028, .imag=0.213110},
                   {.real=0.975702, .imag=0.219101},
                   {.real=0.974339, .imag=0.225084},
                   {.real=0.972940, .imag=0.231058},
                   {.real=0.971504, .imag=0.237024},
                   {.real=0.970031, .imag=0.242980},
                   {.real=0.968522, .imag=0.248928},
                   {.real=0.966976, .imag=0.254866},
                   {.real=0.965394, .imag=0.260794},
                   {.real=0.963776, .imag=0.266713},
                   {.real=0.962121, .imag=0.272621},
                   {.real=0.960431, .imag=0.278520},
                   {.real=0.958703, .imag=0.284408},
                   {.real=0.956940, .imag=0.290285},
                   {.real=0.955141, .imag=0.296151},
                   {.real=0.953306, .imag=0.302006},
                   {.real=0.951435, .imag=0.307850},
                   {.real=0.949528, .imag=0.313682},
                   {.real=0.947586, .imag=0.319502},
                   {.real=0.945607, .imag=0.325310},
                   {.real=0.943593, .imag=0.331106},
                   {.real=0.941544, .imag=0.336890},
                   {.real=0.939459, .imag=0.342661},
                   {.real=0.937339, .imag=0.348419},
                   {.real=0.935184, .imag=0.354164},
                   {.real=0.932993, .imag=0.359895},
                   {.real=0.930767, .imag=0.365613},
                   {.real=0.928506, .imag=0.371317},
                   {.real=0.926210, .imag=0.377007},
                   {.real=0.923880, .imag=0.382683},
                   {.real=0.921514, .imag=0.388345},
                   {.real=0.919114, .imag=0.393992},
                   {.real=0.916679, .imag=0.399624},
                   {.real=0.914210, .imag=0.405241},
                   {.real=0.911706, .imag=0.410843},
                   {.real=0.909168, .imag=0.416430},
                   {.real=0.906596, .imag=0.422000},
                   {.real=0.903989, .imag=0.427555},
                   {.real=0.901349, .imag=0.433094},
                   {.real=0.898674, .imag=0.438616},
                   {.real=0.895966, .imag=0.444122},
                   {.real=0.893224, .imag=0.449611},
                   {.real=0.890449, .imag=0.455084},
                   {.real=0.887640, .imag=0.460539},
                   {.real=0.884797, .imag=0.465976},
                   {.real=0.881921, .imag=0.471397},
                   {.real=0.879012, .imag=0.476799},
                   {.real=0.876070, .imag=0.482184},
                   {.real=0.873095, .imag=0.487550},
                   {.real=0.870087, .imag=0.492898},
                   {.real=0.867046, .imag=0.498228},
                   {.real=0.863973, .imag=0.503538},
                   {.real=0.860867, .imag=0.508830},
                   {.real=0.857729, .imag=0.514103},
                   {.real=0.854558, .imag=0.519356},
                   {.real=0.851355, .imag=0.524590},
                   {.real=0.848120, .imag=0.529804},
                   {.real=0.844854, .imag=0.534998},
                   {.real=0.841555, .imag=0.540171},
                   {.real=0.838225, .imag=0.545325},
                   {.real=0.834863, .imag=0.550458},
                   {.real=0.831470, .imag=0.555570},
                   {.real=0.828045, .imag=0.560662},
                   {.real=0.824589, .imag=0.565732},
                   {.real=0.821103, .imag=0.570781},
                   {.real=0.817585, .imag=0.575808},
                   {.real=0.814036, .imag=0.580814},
                   {.real=0.810457, .imag=0.585798},
                   {.real=0.806848, .imag=0.590760},
                   {.real=0.803208, .imag=0.595699},
                   {.real=0.799537, .imag=0.600616},
                   {.real=0.795837, .imag=0.605511},
                   {.real=0.792107, .imag=0.610383},
                   {.real=0.788346, .imag=0.615232},
                   {.real=0.784557, .imag=0.620057},
                   {.real=0.780737, .imag=0.624859},
                   {.real=0.776888, .imag=0.629638},
                   {.real=0.773010, .imag=0.634393},
                   {.real=0.769103, .imag=0.639124},
                   {.real=0.765167, .imag=0.643832},
                   {.real=0.761202, .imag=0.648514},
                   {.real=0.757209, .imag=0.653173},
                   {.real=0.753187, .imag=0.657807},
                   {.real=0.749136, .imag=0.662416},
                   {.real=0.745058, .imag=0.667000},
                   {.real=0.740951, .imag=0.671559},
                   {.real=0.736817, .imag=0.676093},
                   {.real=0.732654, .imag=0.680601},
                   {.real=0.728464, .imag=0.685084},
                   {.real=0.724247, .imag=0.689541},
                   {.real=0.720003, .imag=0.693971},
                   {.real=0.715731, .imag=0.698376},
                   {.real=0.711432, .imag=0.702755},
                   {.real=0.707107, .imag=0.707107},
                   {.real=0.702755, .imag=0.711432},
                   {.real=0.698376, .imag=0.715731},
                   {.real=0.693971, .imag=0.720003},
                   {.real=0.689541, .imag=0.724247},
                   {.real=0.685084, .imag=0.728464},
                   {.real=0.680601, .imag=0.732654},
                   {.real=0.676093, .imag=0.736817},
                   {.real=0.671559, .imag=0.740951},
                   {.real=0.667000, .imag=0.745058},
                   {.real=0.662416, .imag=0.749136},
                   {.real=0.657807, .imag=0.753187},
                   {.real=0.653173, .imag=0.757209},
                   {.real=0.648514, .imag=0.761202},
                   {.real=0.643832, .imag=0.765167},
                   {.real=0.639124, .imag=0.769103},
                   {.real=0.634393, .imag=0.773010},
                   {.real=0.629638, .imag=0.776888},
                   {.real=0.624859, .imag=0.780737},
                   {.real=0.620057, .imag=0.784557},
                   {.real=0.615232, .imag=0.788346},
                   {.real=0.610383, .imag=0.792107},
                   {.real=0.605511, .imag=0.795837},
                   {.real=0.600616, .imag=0.799537},
                   {.real=0.595699, .imag=0.803208},
                   {.real=0.590760, .imag=0.806848},
                   {.real=0.585798, .imag=0.810457},
                   {.real=0.580814, .imag=0.814036},
                   {.real=0.575808, .imag=0.817585},
                   {.real=0.570781, .imag=0.821103},
                   {.real=0.565732, .imag=0.824589},
                   {.real=0.560662, .imag=0.828045},
                   {.real=0.555570, .imag=0.831470},
                   {.real=0.550458, .imag=0.834863},
                   {.real=0.545325, .imag=0.838225},
                   {.real=0.540171, .imag=0.841555},
                   {.real=0.534998, .imag=0.844854},
                   {.real=0.529804, .imag=0.848120},
                   {.real=0.524590, .imag=0.851355},
                   {.real=0.519356, .imag=0.854558},
                   {.real=0.514103, .imag=0.857729},
                   {.real=0.508830, .imag=0.860867},
                   {.real=0.503538, .imag=0.863973},
                   {.real=0.498228, .imag=0.867046},
                   {.real=0.492898, .imag=0.870087},
                   {.real=0.487550, .imag=0.873095},
                   {.real=0.482184, .imag=0.876070},
                   {.real=0.476799, .imag=0.879012},
                   {.real=0.471397, .imag=0.881921},
                   {.real=0.465976, .imag=0.884797},
                   {.real=0.460539, .imag=0.887640},
                   {.real=0.455084, .imag=0.890449},
                   {.real=0.449611, .imag=0.893224},
                   {.real=0.444122, .imag=0.895966},
                   {.real=0.438616, .imag=0.898674},
                   {.real=0.433094, .imag=0.901349},
                   {.real=0.427555, .imag=0.903989},
                   {.real=0.422000, .imag=0.906596},
                   {.real=0.416430, .imag=0.909168},
                   {.real=0.410843, .imag=0.911706},
                   {.real=0.405241, .imag=0.914210},
                   {.real=0.399624, .imag=0.916679},
                   {.real=0.393992, .imag=0.919114},
                   {.real=0.388345, .imag=0.921514},
                   {.real=0.382683, .imag=0.923880},
                   {.real=0.377007, .imag=0.926210},
                   {.real=0.371317, .imag=0.928506},
                   {.real=0.365613, .imag=0.930767},
                   {.real=0.359895, .imag=0.932993},
                   {.real=0.354164, .imag=0.935184},
                   {.real=0.348419, .imag=0.937339},
                   {.real=0.342661, .imag=0.939459},
                   {.real=0.336890, .imag=0.941544},
                   {.real=0.331106, .imag=0.943593},
                   {.real=0.325310, .imag=0.945607},
                   {.real=0.319502, .imag=0.947586},
                   {.real=0.313682, .imag=0.949528},
                   {.real=0.307850, .imag=0.951435},
                   {.real=0.302006, .imag=0.953306},
                   {.real=0.296151, .imag=0.955141},
                   {.real=0.290285, .imag=0.956940},
                   {.real=0.284408, .imag=0.958703},
                   {.real=0.278520, .imag=0.960431},
                   {.real=0.272621, .imag=0.962121},
                   {.real=0.266713, .imag=0.963776},
                   {.real=0.260794, .imag=0.965394},
                   {.real=0.254866, .imag=0.966976},
                   {.real=0.248928, .imag=0.968522},
                   {.real=0.242980, .imag=0.970031},
                   {.real=0.237024, .imag=0.971504},
                   {.real=0.231058, .imag=0.972940},
                   {.real=0.225084, .imag=0.974339},
                   {.real=0.219101, .imag=0.975702},
                   {.real=0.213110, .imag=0.977028},
                   {.real=0.207111, .imag=0.978317},
                   {.real=0.201105, .imag=0.979570},
                   {.real=0.195090, .imag=0.980785},
                   {.real=0.189069, .imag=0.981964},
                   {.real=0.183040, .imag=0.983105},
                   {.real=0.177004, .imag=0.984210},
                   {.real=0.170962, .imag=0.985278},
                   {.real=0.164913, .imag=0.986308},
                   {.real=0.158858, .imag=0.987301},
                   {.real=0.152797, .imag=0.988258},
                   {.real=0.146730, .imag=0.989177},
                   {.real=0.140658, .imag=0.990058},
                   {.real=0.134581, .imag=0.990903},
                   {.real=0.128498, .imag=0.991710},
                   {.real=0.122411, .imag=0.992480},
                   {.real=0.116319, .imag=0.993212},
                   {.real=0.110222, .imag=0.993907},
                   {.real=0.104122, .imag=0.994565},
                   {.real=0.098017, .imag=0.995185},
                   {.real=0.091909, .imag=0.995767},
                   {.real=0.085797, .imag=0.996313},
                   {.real=0.079682, .imag=0.996820},
                   {.real=0.073565, .imag=0.997290},
                   {.real=0.067444, .imag=0.997723},
                   {.real=0.061321, .imag=0.998118},
                   {.real=0.055195, .imag=0.998476},
                   {.real=0.049068, .imag=0.998795},
                   {.real=0.042938, .imag=0.999078},
                   {.real=0.036807, .imag=0.999322},
                   {.real=0.030675, .imag=0.999529},
                   {.real=0.024541, .imag=0.999699},
                   {.real=0.018407, .imag=0.999831},
                   {.real=0.012272, .imag=0.999925},
                   {.real=0.006136, .imag=0.999981},
                   {.real=0.000000, .imag=1.000000},
                   {.real=-0.006136, .imag=0.999981},
                   {.real=-0.012272, .imag=0.999925},
                   {.real=-0.018407, .imag=0.999831},
                   {.real=-0.024541, .imag=0.999699},
                   {.real=-0.030675, .imag=0.999529},
                   {.real=-0.036807, .imag=0.999322},
                   {.real=-0.042938, .imag=0.999078},
                   {.real=-0.049068, .imag=0.998795},
                   {.real=-0.055195, .imag=0.998476},
                   {.real=-0.061321, .imag=0.998118},
                   {.real=-0.067444, .imag=0.997723},
                   {.real=-0.073565, .imag=0.997290},
                   {.real=-0.079682, .imag=0.996820},
                   {.real=-0.085797, .imag=0.996313},
                   {.real=-0.091909, .imag=0.995767},
                   {.real=-0.098017, .imag=0.995185},
                   {.real=-0.104122, .imag=0.994565},
                   {.real=-0.110222, .imag=0.993907},
                   {.real=-0.116319, .imag=0.993212},
                   {.real=-0.122411, .imag=0.992480},
                   {.real=-0.128498, .imag=0.991710},
                   {.real=-0.134581, .imag=0.990903},
                   {.real=-0.140658, .imag=0.990058},
                   {.real=-0.146730, .imag=0.989177},
                   {.real=-0.152797, .imag=0.988258},
                   {.real=-0.158858, .imag=0.987301},
                   {.real=-0.164913, .imag=0.986308},
                   {.real=-0.170962, .imag=0.985278},
                   {.real=-0.177004, .imag=0.984210},
                   {.real=-0.183040, .imag=0.983105},
                   {.real=-0.189069, .imag=0.981964},
                   {.real=-0.195090, .imag=0.980785},
                   {.real=-0.201105, .imag=0.979570},
                   {.real=-0.207111, .imag=0.978317},
                   {.real=-0.213110, .imag=0.977028},
                   {.real=-0.219101, .imag=0.975702},
                   {.real=-0.225084, .imag=0.974339},
                   {.real=-0.231058, .imag=0.972940},
                   {.real=-0.237024, .imag=0.971504},
                   {.real=-0.242980, .imag=0.970031},
                   {.real=-0.248928, .imag=0.968522},
                   {.real=-0.254866, .imag=0.966976},
                   {.real=-0.260794, .imag=0.965394},
                   {.real=-0.266713, .imag=0.963776},
                   {.real=-0.272621, .imag=0.962121},
                   {.real=-0.278520, .imag=0.960431},
                   {.real=-0.284408, .imag=0.958703},
                   {.real=-0.290285, .imag=0.956940},
                   {.real=-0.296151, .imag=0.955141},
                   {.real=-0.302006, .imag=0.953306},
                   {.real=-0.307850, .imag=0.951435},
                   {.real=-0.313682, .imag=0.949528},
                   {.real=-0.319502, .imag=0.947586},
                   {.real=-0.325310, .imag=0.945607},
                   {.real=-0.331106, .imag=0.943593},
                   {.real=-0.336890, .imag=0.941544},
                   {.real=-0.342661, .imag=0.939459},
                   {.real=-0.348419, .imag=0.937339},
                   {.real=-0.354164, .imag=0.935184},
                   {.real=-0.359895, .imag=0.932993},
                   {.real=-0.365613, .imag=0.930767},
                   {.real=-0.371317, .imag=0.928506},
                   {.real=-0.377007, .imag=0.926210},
                   {.real=-0.382683, .imag=0.923880},
                   {.real=-0.388345, .imag=0.921514},
                   {.real=-0.393992, .imag=0.919114},
                   {.real=-0.399624, .imag=0.916679},
                   {.real=-0.405241, .imag=0.914210},
                   {.real=-0.410843, .imag=0.911706},
                   {.real=-0.416430, .imag=0.909168},
                   {.real=-0.422000, .imag=0.906596},
                   {.real=-0.427555, .imag=0.903989},
                   {.real=-0.433094, .imag=0.901349},
                   {.real=-0.438616, .imag=0.898674},
                   {.real=-0.444122, .imag=0.895966},
                   {.real=-0.449611, .imag=0.893224},
                   {.real=-0.455084, .imag=0.890449},
                   {.real=-0.460539, .imag=0.887640},
                   {.real=-0.465976, .imag=0.884797},
                   {.real=-0.471397, .imag=0.881921},
                   {.real=-0.476799, .imag=0.879012},
                   {.real=-0.482184, .imag=0.876070},
                   {.real=-0.487550, .imag=0.873095},
                   {.real=-0.492898, .imag=0.870087},
                   {.real=-0.498228, .imag=0.867046},
                   {.real=-0.503538, .imag=0.863973},
                   {.real=-0.508830, .imag=0.860867},
                   {.real=-0.514103, .imag=0.857729},
                   {.real=-0.519356, .imag=0.854558},
                   {.real=-0.524590, .imag=0.851355},
                   {.real=-0.529804, .imag=0.848120},
                   {.real=-0.534998, .imag=0.844854},
                   {.real=-0.540171, .imag=0.841555},
                   {.real=-0.545325, .imag=0.838225},
                   {.real=-0.550458, .imag=0.834863},
                   {.real=-0.555570, .imag=0.831470},
                   {.real=-0.560662, .imag=0.828045},
                   {.real=-0.565732, .imag=0.824589},
                   {.real=-0.570781, .imag=0.821103},
                   {.real=-0.575808, .imag=0.817585},
                   {.real=-0.580814, .imag=0.814036},
                   {.real=-0.585798, .imag=0.810457},
                   {.real=-0.590760, .imag=0.806848},
                   {.real=-0.595699, .imag=0.803208},
                   {.real=-0.600616, .imag=0.799537},
                   {.real=-0.605511, .imag=0.795837},
                   {.real=-0.610383, .imag=0.792107},
                   {.real=-0.615232, .imag=0.788346},
                   {.real=-0.620057, .imag=0.784557},
                   {.real=-0.624859, .imag=0.780737},
                   {.real=-0.629638, .imag=0.776888},
                   {.real=-0.634393, .imag=0.773010},
                   {.real=-0.639124, .imag=0.769103},
                   {.real=-0.643832, .imag=0.765167},
                   {.real=-0.648514, .imag=0.761202},
                   {.real=-0.653173, .imag=0.757209},
                   {.real=-0.657807, .imag=0.753187},
                   {.real=-0.662416, .imag=0.749136},
                   {.real=-0.667000, .imag=0.745058},
                   {.real=-0.671559, .imag=0.740951},
                   {.real=-0.676093, .imag=0.736817},
                   {.real=-0.680601, .imag=0.732654},
                   {.real=-0.685084, .imag=0.728464},
                   {.real=-0.689541, .imag=0.724247},
                   {.real=-0.693971, .imag=0.720003},
                   {.real=-0.698376, .imag=0.715731},
                   {.real=-0.702755, .imag=0.711432},
                   {.real=-0.707107, .imag=0.707107},
                   {.real=-0.711432, .imag=0.702755},
                   {.real=-0.715731, .imag=0.698376},
                   {.real=-0.720003, .imag=0.693971},
                   {.real=-0.724247, .imag=0.689541},
                   {.real=-0.728464, .imag=0.685084},
                   {.real=-0.732654, .imag=0.680601},
                   {.real=-0.736817, .imag=0.676093},
                   {.real=-0.740951, .imag=0.671559},
                   {.real=-0.745058, .imag=0.667000},
                   {.real=-0.749136, .imag=0.662416},
                   {.real=-0.753187, .imag=0.657807},
                   {.real=-0.757209, .imag=0.653173},
                   {.real=-0.761202, .imag=0.648514},
                   {.real=-0.765167, .imag=0.643832},
                   {.real=-0.769103, .imag=0.639124},
                   {.real=-0.773010, .imag=0.634393},
                   {.real=-0.776888, .imag=0.629638},
                   {.real=-0.780737, .imag=0.624859},
                   {.real=-0.784557, .imag=0.620057},
                   {.real=-0.788346, .imag=0.615232},
                   {.real=-0.792107, .imag=0.610383},
                   {.real=-0.795837, .imag=0.605511},
                   {.real=-0.799537, .imag=0.600616},
                   {.real=-0.803208, .imag=0.595699},
                   {.real=-0.806848, .imag=0.590760},
                   {.real=-0.810457, .imag=0.585798},
                   {.real=-0.814036, .imag=0.580814},
                   {.real=-0.817585, .imag=0.575808},
                   {.real=-0.821103, .imag=0.570781},
                   {.real=-0.824589, .imag=0.565732},
                   {.real=-0.828045, .imag=0.560662},
                   {.real=-0.831470, .imag=0.555570},
                   {.real=-0.834863, .imag=0.550458},
                   {.real=-0.838225, .imag=0.545325},
                   {.real=-0.841555, .imag=0.540171},
                   {.real=-0.844854, .imag=0.534998},
                   {.real=-0.848120, .imag=0.529804},
                   {.real=-0.851355, .imag=0.524590},
                   {.real=-0.854558, .imag=0.519356},
                   {.real=-0.857729, .imag=0.514103},
                   {.real=-0.860867, .imag=0.508830},
                   {.real=-0.863973, .imag=0.503538},
                   {.real=-0.867046, .imag=0.498228},
                   {.real=-0.870087, .imag=0.492898},
                   {.real=-0.873095, .imag=0.487550},
                   {.real=-0.876070, .imag=0.482184},
                   {.real=-0.879012, .imag=0.476799},
                   {.real=-0.881921, .imag=0.471397},
                   {.real=-0.884797, .imag=0.465976},
                   {.real=-0.887640, .imag=0.460539},
                   {.real=-0.890449, .imag=0.455084},
                   {.real=-0.893224, .imag=0.449611},
                   {.real=-0.895966, .imag=0.444122},
                   {.real=-0.898674, .imag=0.438616},
                   {.real=-0.901349, .imag=0.433094},
                   {.real=-0.903989, .imag=0.427555},
                   {.real=-0.906596, .imag=0.422000},
                   {.real=-0.909168, .imag=0.416430},
                   {.real=-0.911706, .imag=0.410843},
                   {.real=-0.914210, .imag=0.405241},
                   {.real=-0.916679, .imag=0.399624},
                   {.real=-0.919114, .imag=0.393992},
                   {.real=-0.921514, .imag=0.388345},
                   {.real=-0.923880, .imag=0.382683},
                   {.real=-0.926210, .imag=0.377007},
                   {.real=-0.928506, .imag=0.371317},
                   {.real=-0.930767, .imag=0.365613},
                   {.real=-0.932993, .imag=0.359895},
                   {.real=-0.935184, .imag=0.354164},
                   {.real=-0.937339, .imag=0.348419},
                   {.real=-0.939459, .imag=0.342661},
                   {.real=-0.941544, .imag=0.336890},
                   {.real=-0.943593, .imag=0.331106},
                   {.real=-0.945607, .imag=0.325310},
                   {.real=-0.947586, .imag=0.319502},
                   {.real=-0.949528, .imag=0.313682},
                   {.real=-0.951435, .imag=0.307850},
                   {.real=-0.953306, .imag=0.302006},
                   {.real=-0.955141, .imag=0.296151},
                   {.real=-0.956940, .imag=0.290285},
                   {.real=-0.958703, .imag=0.284408},
                   {.real=-0.960431, .imag=0.278520},
                   {.real=-0.962121, .imag=0.272621},
                   {.real=-0.963776, .imag=0.266713},
                   {.real=-0.965394, .imag=0.260794},
                   {.real=-0.966976, .imag=0.254866},
                   {.real=-0.968522, .imag=0.248928},
                   {.real=-0.970031, .imag=0.242980},
                   {.real=-0.971504, .imag=0.237024},
                   {.real=-0.972940, .imag=0.231058},
                   {.real=-0.974339, .imag=0.225084},
                   {.real=-0.975702, .imag=0.219101},
                   {.real=-0.977028, .imag=0.213110},
                   {.real=-0.978317, .imag=0.207111},
                   {.real=-0.979570, .imag=0.201105},
                   {.real=-0.980785, .imag=0.195090},
                   {.real=-0.981964, .imag=0.189069},
                   {.real=-0.983105, .imag=0.183040},
                   {.real=-0.984210, .imag=0.177004},
                   {.real=-0.985278, .imag=0.170962},
                   {.real=-0.986308, .imag=0.164913},
                   {.real=-0.987301, .imag=0.158858},
                   {.real=-0.988258, .imag=0.152797},
                   {.real=-0.989177, .imag=0.146730},
                   {.real=-0.990058, .imag=0.140658},
                   {.real=-0.990903, .imag=0.134581},
                   {.real=-0.991710, .imag=0.128498},
                   {.real=-0.992480, .imag=0.122411},
                   {.real=-0.993212, .imag=0.116319},
                   {.real=-0.993907, .imag=0.110222},
                   {.real=-0.994565, .imag=0.104122},
                   {.real=-0.995185, .imag=0.098017},
                   {.real=-0.995767, .imag=0.091909},
                   {.real=-0.996313, .imag=0.085797},
                   {.real=-0.996820, .imag=0.079682},
                   {.real=-0.997290, .imag=0.073565},
                   {.real=-0.997723, .imag=0.067444},
                   {.real=-0.998118, .imag=0.061321},
                   {.real=-0.998476, .imag=0.055195},
                   {.real=-0.998795, .imag=0.049068},
                   {.real=-0.999078, .imag=0.042938},
                   {.real=-0.999322, .imag=0.036807},
                   {.real=-0.999529, .imag=0.030675},
                   {.real=-0.999699, .imag=0.024541},
                   {.real=-0.999831, .imag=0.018407},
                   {.real=-0.999925, .imag=0.012272}};

//0 - forward, 1 - backward(invert)
void fft(complex *a, int n, int invert) {

    for (int i = 1, j = 0; i < n; ++i) {
        int bit = n >> 1;
        for (; j >= bit; bit >>= 1)
            j -= bit;
        j += bit;
        if (i < j)
            swap(&a[i], &a[j]);
    }

    for (int b = 1; b < n; b <<= 1) {
        for (int i = 0; i < n; i += 2 * b) {
            for (int k = 0; k < b; k++) {
                if (invert == 0) {
                    complex temp = a[i + k];
                    a[i + k] = csum(a[i + k], cproduct(w_arr[b + k], a[i + b + k]));
                    a[i + b + k] = csub(temp, cproduct(w_arr[b + k], a[i + b + k]));
                } else {
                    complex w = w_arr[b + k];
                    w.imag = -w.imag;
                    complex temp = a[i + k];
                    a[i + k] = csum(a[i + k], cproduct(w, a[i + b + k]));
                    a[i + b + k] = csub(temp, cproduct(w, a[i + b + k]));
                }
            }
        }
    }
    if (invert == 1)
        for (int i = 0; i < n; i++) {
            a[i] = cdivz(a[i], n);
        }
}

/////////////////////////

void i2sInputInit() {
    i2s_config_t i2s_config = {
            .mode = (i2s_mode_t) (I2S_MODE_MASTER | I2S_MODE_RX | I2S_MODE_ADC_BUILT_IN),
            .sample_rate =  I2S_SAMPLE_RATE,              // The format of the signal using ADC_BUILT_IN
            .bits_per_sample = I2S_BITS_PER_SAMPLE_16BIT, // is fixed at 12bit, stereo, MSB
            .channel_format = I2S_CHANNEL_FMT_RIGHT_LEFT,
            .communication_format = I2S_COMM_FORMAT_STAND_I2S,
            .intr_alloc_flags = ESP_INTR_FLAG_LEVEL1,
            .dma_buf_count = 8,
            .dma_buf_len = I2S_DMA_BUF_LEN,
            .use_apll = false,
            .tx_desc_auto_clear = true,
            .fixed_mclk = 0
    };

    i2s_driver_install(I2S_NUM_0, &i2s_config, 0, NULL);
    i2s_set_adc_mode(ADC_UNIT_1, ADC_INPUT);
    i2s_adc_enable(I2S_NUM_0);
    adc1_config_channel_atten(ADC_INPUT, ADC_ATTEN_DB_11);
}

void i2sOutputInit() {

    // Initialize I2S
    i2s_config_t i2s_config = {
            .mode = (i2s_mode_t) (I2S_MODE_MASTER | I2S_MODE_TX),
            .sample_rate = I2S_SAMPLE_RATE,
            .bits_per_sample = I2S_BITS_PER_SAMPLE_16BIT,
            .channel_format = I2S_CHANNEL_FMT_RIGHT_LEFT,
            .communication_format = I2S_COMM_FORMAT_STAND_I2S,
            .intr_alloc_flags = ESP_INTR_FLAG_LEVEL1,
            .dma_buf_count = 8,
            .dma_buf_len = I2S_DMA_BUF_LEN,
            .use_apll = true,
            .tx_desc_auto_clear = true,
            .fixed_mclk = 0,
    };
    i2s_driver_install(I2S_NUM_1, &i2s_config, 0, NULL);

    // Configure I2S pins
    i2s_pin_config_t pin_config = {
            .bck_io_num = I2S_BCLK_PIN,
            .ws_io_num = I2S_LRCK_PIN,
            .data_out_num = I2S_DATA_PIN,
            .data_in_num = I2S_PIN_NO_CHANGE,
    };
    i2s_set_pin(I2S_NUM_1, &pin_config);
}

complex *temp = (complex *) malloc(I2S_DMA_BUF_LEN * sizeof(complex));

void setup() {
    Serial.begin(115200);
    i2sInputInit();
    i2sOutputInit();

    for (int i = 0; i < I2S_DMA_BUF_LEN; i++) {
        temp[i].real = i;
    }
}


void loop() {
    size_t bytes_read;
    size_t bytes_written;
    complex *buffer = (complex *) malloc(I2S_DMA_BUF_LEN * sizeof(complex));
//    uint8_t *buffer = (uint8_t *) malloc(I2S_DMA_BUF_LEN * sizeof(uint8_t));
    i2s_read(I2S_NUM_0, &buffer->real, I2S_DMA_BUF_LEN, &bytes_read, portMAX_DELAY);
//    fft(temp, I2S_DMA_BUF_LEN, 0);
//    fft(buffer, I2S_DMA_BUF_LEN, 1);
    i2s_write(I2S_NUM_1, &buffer->real, I2S_DMA_BUF_LEN, &bytes_written, portMAX_DELAY);
    free(buffer);
}